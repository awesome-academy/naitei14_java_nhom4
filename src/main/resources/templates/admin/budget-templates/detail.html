<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      th:replace="~{admin/fragments/layout :: layout(~{::content})}">
<body>
<div th:fragment="content">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h3 class="text-primary">
            <i class="fas fa-file-invoice-dollar"></i> Chi tiết Mẫu Ngân sách #<span th:text="${template.id}"></span>
        </h3>
        <div>
            <a th:href="@{'/admin/budget-templates/edit/' + ${template.id}}" class="btn btn-warning">
                <i class="fas fa-edit"></i> Chỉnh sửa
            </a>
            <a th:href="@{/admin/budget-templates}" class="btn btn-secondary">
                <i class="fas fa-arrow-left"></i> Quay lại
            </a>
        </div>
    </div>

    <div class="row">
        <div class="col-md-6">
            <div class="card shadow mb-4">
                <div class="card-header bg-primary text-white">
                    <h6 class="m-0"><i class="fas fa-info-circle"></i> Thông tin cơ bản</h6>
                </div>
                <div class="card-body">
                    <table class="table table-borderless mb-0">
                        <tr>
                            <th class="text-muted" style="width: 40%;">Tên mẫu:</th>
                            <td class="fw-bold" th:text="${template.name}"></td>
                        </tr>
                        <tr>
                            <th class="text-muted">Tháng:</th>
                            <td><span class="badge bg-primary fs-6">Tháng [[${template.month}]]</span></td>
                        </tr>
                        <tr>
                            <th class="text-muted">Mô tả:</th>
                            <td th:text="${template.description ?: 'Không có mô tả'}"></td>
                        </tr>
                        <tr>
                            <th class="text-muted">Ngày tạo:</th>
                            <td th:text="${#dates.format(template.createdAt, 'dd/MM/yyyy HH:mm:ss')}"></td>
                        </tr>
                        <tr>
                            <th class="text-muted">Cập nhật lần cuối:</th>
                            <td th:text="${#dates.format(template.updatedAt, 'dd/MM/yyyy HH:mm:ss')}"></td>
                        </tr>
                    </table>
                </div>
            </div>
        </div>

        <div class="col-md-6">
            <div class="card shadow mb-4">
                <div class="card-header bg-info text-white">
                    <h6 class="m-0"><i class="fas fa-chart-pie"></i> Tổng quan</h6>
                </div>
                <div class="card-body text-center">
                    <h2 class="text-primary mb-0" th:text="${template.items != null ? template.items.size() : 0}"></h2>
                    <p class="text-muted mb-3">Danh mục ngân sách</p>
                    
                    <h3 class="text-success mb-0">
                        <span th:text="${#numbers.formatDecimal(totalAmount, 0, 'COMMA', 0, 'POINT')}">0</span>
                        <small class="fs-6">VND</small>
                    </h3>
                    <p class="text-muted">Tổng ngân sách mặc định</p>
                </div>
            </div>
        </div>
    </div>

    <div class="card shadow">
        <div class="card-header bg-success text-white">
            <h6 class="m-0"><i class="fas fa-list"></i> Danh sách danh mục & Số tiền mặc định</h6>
        </div>
        <div class="card-body p-0">
            <div class="table-responsive">
                <table class="table table-striped table-hover mb-0 align-middle">
                    <thead class="table-dark">
                    <tr>
                        <th style="width: 60px;">#</th>
                        <th>Danh mục</th>
                        <th class="text-end">Số tiền mặc định</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr th:if="${template.items == null or template.items.isEmpty()}">
                        <td colspan="3" class="text-center py-5 text-muted">
                            <i class="fas fa-inbox fa-3x mb-3"></i><br>
                            Mẫu này chưa có danh mục nào.
                        </td>
                    </tr>

                    <tr th:each="item, iterStat : ${template.items}">
                        <td><span class="badge bg-secondary" th:text="${iterStat.index + 1}"></span></td>
                        <td>
                            <span class="badge bg-info text-dark">
                                <i class="fas fa-tag me-1"></i>
                                <span th:text="${item.category?.name ?: 'N/A'}"></span>
                            </span>
                        </td>
                        <td class="text-end fw-bold text-success">
                            <span th:text="${#numbers.formatDecimal(item.defaultAmount, 0, 'COMMA', 0, 'POINT')}"></span>
                            <small>VND</small>
                        </td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>
</body>
</html>
